<!DOCTYPE html>
<html>
    <head>
        <script type="text/javascript">
            var display;
            var table;
            var title;
 
            function Main(){               
                url=document.getElementById("dest").value;              
                xmlDoc=loadXML(url);
                var content=processXml(xmlDoc);
                var win=window.open();
                win.document.write(content);
            }
            
            
            function processXml(xmlDoc){
                display="<!DOCTYPE html><html><head><title>Online Newspaper Listings</title></head><body>";
                table="<table border='1'align='center'>";

                addTitle(xmlDoc);
                                
                var total=xmlDoc.getElementsByTagName("Row");
              
                for(i=1;i<=total.length;i++){
                    
                    addItem(xmlDoc,i-1);
                }
                table=table+"</table>";
                display=display+table+"</body></html>";
                return display;
            }
            
            function addTitle(xmlDoc){
                table=table+"<tr>"
                title=xmlDoc.getElementsByTagName("Data");
                for(i=0;i<title.length;i++){
                    table=table+"<th>"+title[i].firstChild.nodeValue+"</th>"
                }
                table=table+"</tr>"            
        
            }
            function addItem(xmlDoc,i){
                
                table=table+"<tr>"
                addSlot(xmlDoc,i);
                addName(xmlDoc,i);
                addLocation(xmlDoc,i);
                addHomePage(xmlDoc,i);
                addLogo(xmlDoc,i);
                table=table+"</tr>"

            }
            function addSlot(xmlDoc,i){
                table=table+"<td>"+(i+1)+"</td>";
            }
            function addName(xmlDoc,i){
//              var Name=title[1].firstChild.nodeValue;
                table=table+"<td>"+xmlDoc.getElementsByTagName("Newspaper")[i].firstChild.nodeValue+"</td>";
            }
            function addLocation(xmlDoc,i){
                table=table+"<td>";
                table=table+"<ul><li>"+xmlDoc.getElementsByTagName("City")[i].firstChild.nodeValue+"</li><li>"+xmlDoc.getElementsByTagName("State")[i].firstChild.nodeValue+"</li>";
                table=table+"</td>";
            }
            function addHomePage(xmlDoc,i){
                table=table+"<td>";
                table=table+"<a href='"+xmlDoc.getElementsByTagName("HomePage")[i].firstChild.nodeValue+"'>"+xmlDoc.getElementsByTagName("HomePage")[i].firstChild.nodeValue+"</a>"
                table=table+"</td>";
            }
            function addLogo(xmlDoc,i){
                table=table+"<td>"; 
                table=table+"<img src="+xmlDoc.getElementsByTagName("Logo")[i].firstChild.nodeValue+">"
                table=table+"</td>";                
            }
            
            function loadXML(url) {
                if (window.XMLHttpRequest)
                {
                    // code for IE7+, Firefox, Chrome, Opera, Safari
                    xmlhttp=new XMLHttpRequest();
                }
                else
                {
                    // code for IE6, IE5
                    xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
                }
                    if (xmlhttp!=null)
                {
                    xmlhttp.open("GET",url,false); //open, send, responseXML are
                    xmlhttp.send(); //properties of XMLHTTPRequest
                }
                    else
                {
                    alert("Your browser does not support XMLHTTP.");
                }
                
                if(xmlhttp.responseXML==null)
                {
                    if(xmlhttp.status==404)
                    alert("404, XMLFile not exists");
                   
                    if(xmlhttp.status==200)
                    alert("200, But XMLFile Error");
                }
                
                var xmlDoc=xmlhttp.responseXML;
                return xmlDoc;
            }

        </script>
    </head> 
    <body style="text-align:center">
        <div style="margin-left:auto;margin-right:auto;margin-top:100px">
        <h3 style="font-family: Times New Roman">Enter URL for Newspaper List XML File</h3>
        <form>
        <input type="text" id="dest" style="display:inline-block;margin-buttom:100px"/><br><br>
        <input type="submit" value="Submit Query!" onclick="Main()"/>
        </form>
        </div>    
    </body>
</html>    